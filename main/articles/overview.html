<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="shrinkforest">
<title>High level structure â€¢ shrinkforest</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="High level structure">
<meta property="og:description" content="shrinkforest">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">shrinkforest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9030</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example_guide.html">example_guide</a>
    <a class="dropdown-item" href="../articles/hello.html">Hello</a>
    <a class="dropdown-item" href="../articles/high_level_structure.html">High level structure</a>
    <a class="dropdown-item" href="../articles/overview.html">High level structure</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/shrinkforest">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>High level structure</h1>
            
            <h4 data-toc-skip class="date">2023-01-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/shrinkforest/blob/HEAD/vignettes/overview.Rmd" class="external-link"><code>vignettes/overview.Rmd</code></a></small>
      <div class="d-none name"><code>overview.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In randomized clinical trials the homogeneity of treatment effect
estimates in subgroups is studied using forest plots. However, the naive
way of estimating these subgroup treatment effects has to be interpreted
with great care because of the smaller sample size of the subgroups
(leading to large variability of the estimated effects) and the
frequently large number of investigated subgroups.</p>
<p>Subgroup treatment effect estimates with a lower mean-square error
based on frequentist and Bayesian shrinkage have been studied. In this
package we are implementing the functions needed to apply these
shrinkage methods to data sets with survival and binary outcomes.</p>
</div>
<div class="section level2">
<h2 id="treatment-effect-estimation-methods">Treatment effect estimation methods<a class="anchor" aria-label="anchor" href="#treatment-effect-estimation-methods"></a>
</h2>
<div class="section level3">
<h3 id="naive-overall-population-model-estimation">Naive Overall Population Model Estimation<a class="anchor" aria-label="anchor" href="#naive-overall-population-model-estimation"></a>
</h3>
<p>To estimate the treatment effect of the different subgroups we can
always consider the naive estimate based on the overall population. This
will lead to the same treatment effect for all the subgroups (the naive
treatment effect obtained from all the population).</p>
<p>In our package this overall population treatment effect can be
estimated using the function <code>naivepop</code>.</p>
<p>Given the response and the treatment variables, this function fits a
model with all the data giving us the information to obtain an estimate
of the treatment effects.</p>
<p>In the case of time-to-event data we will fit a Cox regression with a
censoring variable, with the treatment as explanatory variable and with
the time to event as response variable. By taking the exponential of the
coefficient associated with treatment we obtain the hazard ratio.</p>
<p>In the case of data with binary outcome we will fit a logistic
regression model with treatment as explanatory variable and with the
binary considered variable as response. The coefficient associated with
treatment can be interpreted as the log odds ratio.</p>
</div>
<div class="section level3">
<h3 id="naive-model-estimation">Naive Model Estimation<a class="anchor" aria-label="anchor" href="#naive-model-estimation"></a>
</h3>
<p>The traditional way to estimate the treatment effect of the different
subgroups is what we call the naive estimation.</p>
<p>In our package this naive treatment effect estimation can be
performed using the function <code>naive</code>.</p>
<p>Given the response, treatment and subgroup variables, this function
fits a model in each one of the data sets corresponding to a specific
subgroup (for example if the subgroup that we are studying is Sex=Female
we are going to fit the model just with the data of the patients that
are female) in order to obtain the necessary information to estimate the
specific treatment effects.</p>
<p>In the case of time-to-event data, for each one of the
subgroup-specific data sets, we will fit a Cox regression with a
censoring variable, with the treatment as explanatory variable and with
the time to event as response variable. By taking the exponential of the
coefficient associated with treatment we obtain the hazard ratio
associated with the specific subgroup.</p>
<p>In the case of data with binary outcome, for each one of the
subgroup-specific data sets, we will fit a logistic regression model
with treatment as explanatory variable and with the binary considered
variable as response. The coefficients associated with treatment can be
interpreted as the log odds ratio associated with the specific
subgroup.</p>
</div>
<div class="section level3">
<h3 id="elastic-net-penalization-model-estimation">Elastic Net Penalization Model Estimation<a class="anchor" aria-label="anchor" href="#elastic-net-penalization-model-estimation"></a>
</h3>
<p>We are going to obtain the subgroup treatment effects by fitting a
model with all the available covariates and their interactions with
treatment and by shrinking these interaction coefficients. The idea is
to see if the different subgroups have a different treatment response
from the overall population one (as we put these interaction
coefficients to zero we are shrinking the subgroup treatment effect in
the direction of the overall population treatment effect).</p>
<p>One option to shrink these coefficients is using a frequentist
shrinkage model like the elastic net (ridge and lasso are special cases
of it). It is important to leave the main effects unpenalized so we need
to fit the model taking into account the different penalizations.
Depending on the data we are going to fit a penalized Cox regression
(for survival data) or a penalized logistic regression (for binary
data). To obtain the subgroup treatment effects from this penalized
model we need to marginalize over the different subgroups.</p>
</div>
<div class="section level3">
<h3 id="bayesian-shrinkage-model-estimation">Bayesian Shrinkage Model Estimation<a class="anchor" aria-label="anchor" href="#bayesian-shrinkage-model-estimation"></a>
</h3>
<p>We are going to obtain the subgroup treatment effects by fitting a
bayesian model with all the available covariates and their interactions
with treatment. We are applying over these interaction coefficients a
shrinkage prior while over the main effect coefficients we apply a
normal prior with a wide variance (we are consider a not very
informative prior).</p>
<p>The shrinkage prior chosen for the interaction coefficients is the
horseshoe prior as it shrinks towards zero the coefficients that are
close to zero but leaves unpenalized the large coefficients. As we want
to detect the large differences between subgroup-specific treatment
effects and the overall population effect it is interesting that those
large differences are not shrunken towards zero.</p>
<p>After fitting the model we are going to have samples from the
estimated posterior distribution of these coefficients. With them, after
marginalizing over the different subgroups, we are going to be able to
obtain the subgroup treatment effects estimates.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mar Vazquez Rabunal.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
