<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="shrinkforest">
<title>example_guide • shrinkforest</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="example_guide">
<meta property="og:description" content="shrinkforest">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-125641273-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-125641273-1');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">shrinkforest</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9031</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/example_guide.html">example_guide</a>
    <a class="dropdown-item" href="../articles/hello.html">Hello</a>
    <a class="dropdown-item" href="../articles/high_level_structure.html">High level structure</a>
    <a class="dropdown-item" href="../articles/overview.html">High level structure</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/insightsengineering/shrinkforest">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>example_guide</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/insightsengineering/shrinkforest/blob/HEAD/vignettes/example_guide.Rmd" class="external-link"><code>vignettes/example_guide.Rmd</code></a></small>
      <div class="d-none name"><code>example_guide.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/insightsengineering/shrinkforest/" class="external-link">shrinkforest</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette we are going to show with an example how to use this
package.</p>
<p>We are going to consider a data set with time to event data and 10
categorical covariates. These categorical covariates define 25
subgroups. We are interested in estimating the subgroup treatment effect
(in this case the subgroup hazard ratio) of each one of these 25
subgroups. To do so we are going to use all the methods available in
this package and we are going to compare their results using a forest
plot.</p>
</div>
<div class="section level2">
<h2 id="data-analysis">Data analysis<a class="anchor" aria-label="anchor" href="#data-analysis"></a>
</h2>
<p>As it was mentioned before we are going to use survival data as an
example of how to use the package. In our data (that should be of class
<code>data.frame</code>) we should have columns with the following
variables:</p>
<ul>
<li><p>Treatment: factor variable with two levels (the first level
represents the control group and the second one the treatment group). It
is important to make sure that this variable is a factor and that the
levels are in the correct order.</p></li>
<li><p>Response: in the case of survival data this should be a numeric
variable with the survival time.</p></li>
<li><p>Status: in the case of survival data this variable should be
present and is a numeric variable with 0 and 1 indicating whether the
observation was censored or not.</p></li>
<li><p>Categorical variables: factor variables with information about
the individuals. The levels of these variables are going to be the
subgroups that we are interested in studying.</p></li>
</ul>
<p>In our case we have the following structure of the data:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1000 obs. of  14 variables:</span></span>
<span><span class="co">#&gt;  $ id    : int  1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span><span class="co">#&gt;  $ arm   : Factor w/ 2 levels "0","1": 1 1 1 1 2 2 2 2 2 1 ...</span></span>
<span><span class="co">#&gt;  $ x_1   : Factor w/ 2 levels "a","b": 2 2 1 1 2 1 1 2 2 1 ...</span></span>
<span><span class="co">#&gt;  $ x_2   : Factor w/ 2 levels "a","b": 1 2 1 1 1 2 2 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ x_3   : Factor w/ 2 levels "a","b": 2 1 2 1 2 2 2 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ x_4   : Factor w/ 3 levels "a","b","c": 2 1 3 3 3 3 3 1 3 3 ...</span></span>
<span><span class="co">#&gt;  $ x_5   : Factor w/ 4 levels "a","b","c","d": 4 4 1 1 4 1 3 4 4 3 ...</span></span>
<span><span class="co">#&gt;  $ x_6   : Factor w/ 2 levels "a","b": 2 1 2 2 2 1 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ x_7   : Factor w/ 2 levels "a","b": 2 1 2 2 2 1 1 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ x_8   : Factor w/ 3 levels "a","b","c": 3 2 1 3 3 3 1 1 2 3 ...</span></span>
<span><span class="co">#&gt;  $ x_9   : Factor w/ 2 levels "a","b": 2 1 2 2 2 1 1 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ x_10  : Factor w/ 3 levels "a","b","c": 3 3 3 3 3 1 2 2 2 3 ...</span></span>
<span><span class="co">#&gt;  $ tt_pfs: num  0.9795 3.4762 1.7947 0.0197 2.2168 ...</span></span>
<span><span class="co">#&gt;  $ ev_pfs: num  1 0 1 1 0 0 0 0 0 0 ...</span></span></code></pre></div>
<p>We have that <code>arm</code> is our treatment variable,
<code>x_1</code> to <code>x_10</code> are the categorical covariates,
<code>tt_pfs</code> is the response variable and <code>ev_pfs</code> is
the status variable.</p>
<p>Once that we are sure that our data is in the correct format and
contains all the necessary variables, we are going to fit the different
models in order to obtain the subgroup treatment effects.</p>
</div>
<div class="section level2">
<h2 id="fit-models-and-check-summary">Fit Models and Check Summary<a class="anchor" aria-label="anchor" href="#fit-models-and-check-summary"></a>
</h2>
<div class="section level3">
<h3 id="naivepop">Naivepop<a class="anchor" aria-label="anchor" href="#naivepop"></a>
</h3>
<p>Let’s start by fitting the model that will lead to an overall
treatment effect estimation.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naivepop_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naivepop.html">naivepop</a></span><span class="op">(</span>resp <span class="op">=</span> <span class="st">"tt_pfs"</span>, trt <span class="op">=</span> <span class="st">"arm"</span>, data <span class="op">=</span> <span class="va">example_data</span>, resptype <span class="op">=</span> <span class="st">"survival"</span>, status <span class="op">=</span> <span class="st">"ev_pfs"</span><span class="op">)</span></span></code></pre></div>
<p>This new <code>naivepop</code> object contains the fitted model, the
kind of model that was fitted, the response type of the data and the
data.</p>
<p>We can take the summary of this object to obtain the overall
treatment effect estimate (in this case the overall hazard ratio).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_naivepop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">naivepop_model</span><span class="op">)</span></span>
<span><span class="va">summary_naivepop</span></span>
<span><span class="co">#&gt;     arm1 </span></span>
<span><span class="co">#&gt; 0.666919</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="naive">Naive<a class="anchor" aria-label="anchor" href="#naive"></a>
</h3>
<p>Now we are going to fit the model to obtain the naive
subgroup-specific treatment effects. We have to indicate which
categorical variables we want to consider to obtain the subgroup
treatment effects. If we add variable <code>x_1</code> we are going to
obtain the subgroup treatment effect of the subgroups <code>x_1a</code>
and <code>x_1b</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">naive_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/naive.html">naive</a></span><span class="op">(</span></span>
<span>  resp <span class="op">=</span> <span class="st">"tt_pfs"</span>, trt <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  subgr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x_1"</span>, <span class="st">"x_2"</span>, <span class="st">"x_3"</span>, <span class="st">"x_4"</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">example_data</span>, resptype <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"ev_pfs"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This <code>naive</code> object contains the fitted models for each
one of the subgroups, the main information about the coefficients
associated to treatment of these fitted models, the kind of models
fitted, the response type and the data.</p>
<p>We can take the summary of this object to obtain the subgroup
treatment effects. We can also include a value for the confidence level
in order to obtain confidence intervals for these subgroup treatment
effect estimates. By default this confidence level is of 95%.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_naive</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">naive_model</span>, conf <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span></span>
<span><span class="va">summary_naive</span></span>
<span><span class="co">#&gt;   subgroup trt.estimate   trt.low  trt.high</span></span>
<span><span class="co">#&gt; 1     x_1a    0.6741880 0.4975147 0.9135999</span></span>
<span><span class="co">#&gt; 2     x_1b    0.6645867 0.4936858 0.8946489</span></span>
<span><span class="co">#&gt; 3     x_2a    0.7087873 0.5060265 0.9927928</span></span>
<span><span class="co">#&gt; 4     x_2b    0.6424496 0.4886396 0.8446746</span></span>
<span><span class="co">#&gt; 5     x_3a    0.5054825 0.3265821 0.7823840</span></span>
<span><span class="co">#&gt; 6     x_3b    0.7168399 0.5621416 0.9141103</span></span>
<span><span class="co">#&gt; 7     x_4a    0.6213593 0.4413407 0.8748057</span></span>
<span><span class="co">#&gt; 8     x_4b    0.5428680 0.3640585 0.8095008</span></span>
<span><span class="co">#&gt; 9     x_4c    0.8575696 0.5892299 1.2481132</span></span></code></pre></div>
<p>We can add a forest plot with the estimated treatment effects:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">summary_naive</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_guide_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="elastic-net">Elastic Net<a class="anchor" aria-label="anchor" href="#elastic-net"></a>
</h3>
<p>We are going to fit a model considering an elastic net penalization
on the subgroup treatment interaction coefficients. Depending on the
value of <code>alpha</code> we are going to have different kinds of
penalties. If we put <code>alpha</code> to 0 we consider a ridge penalty
and if we put <code>alpha</code> to 1 we consider a lasso penalty. We
are going to fit both lasso and ridge.</p>
<p>We have to add the <code>covars</code> argument which indicates which
categorical variables we want to include in our model. It is important
that all the variables that are in <code>subgr</code> are also in
<code>covars</code>. The idea is that we can include many variables but
then only find the subgroup treatment effect of some of them.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ridge_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/elastic_net.html">elastic_net</a></span><span class="op">(</span></span>
<span>  resp <span class="op">=</span> <span class="st">"tt_pfs"</span>, trt <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  subgr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x_1"</span>, <span class="st">"x_2"</span>, <span class="st">"x_3"</span>, <span class="st">"x_4"</span><span class="op">)</span>,</span>
<span>  covars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"x_1"</span>, <span class="st">"x_2"</span>, <span class="st">"x_3"</span>, <span class="st">"x_4"</span>, <span class="st">"x_5"</span>,</span>
<span>    <span class="st">"x_6"</span>, <span class="st">"x_7"</span>, <span class="st">"x_8"</span>, <span class="st">"x_9"</span>, <span class="st">"x_10"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">example_data</span>, resptype <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0</span>, status <span class="op">=</span> <span class="st">"ev_pfs"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">lasso_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/elastic_net.html">elastic_net</a></span><span class="op">(</span></span>
<span>  resp <span class="op">=</span> <span class="st">"tt_pfs"</span>, trt <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  subgr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x_1"</span>, <span class="st">"x_2"</span>, <span class="st">"x_3"</span>, <span class="st">"x_4"</span><span class="op">)</span>,</span>
<span>  covars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"x_1"</span>, <span class="st">"x_2"</span>, <span class="st">"x_3"</span>, <span class="st">"x_4"</span>, <span class="st">"x_5"</span>,</span>
<span>    <span class="st">"x_6"</span>, <span class="st">"x_7"</span>, <span class="st">"x_8"</span>, <span class="st">"x_9"</span>, <span class="st">"x_10"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">example_data</span>, resptype <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>, status <span class="op">=</span> <span class="st">"ev_pfs"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These <code>elastic_net</code> models contain the fitted models, the
response type, the data, the value of <code>alpha</code>, the design and
the dummy matrices (that are later going to be used to obtain the
subgroup treatment effects), the response and status variables and the
names of the subgroups.</p>
<p>We are now going to obtain the summary of these fitted objects to
find the subgroup hazard ratio estimates.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_ridge</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ridge_model</span><span class="op">)</span></span>
<span><span class="va">summary_ridge</span></span>
<span><span class="co">#&gt;   subgroup trt.estimate</span></span>
<span><span class="co">#&gt; 1     x_1a    0.6514162</span></span>
<span><span class="co">#&gt; 2     x_1b    0.6494716</span></span>
<span><span class="co">#&gt; 3     x_2a    0.6511461</span></span>
<span><span class="co">#&gt; 4     x_2b    0.6501897</span></span>
<span><span class="co">#&gt; 5     x_3a    0.6413243</span></span>
<span><span class="co">#&gt; 6     x_3b    0.6523088</span></span>
<span><span class="co">#&gt; 7     x_4a    0.6449626</span></span>
<span><span class="co">#&gt; 8     x_4b    0.6449838</span></span>
<span><span class="co">#&gt; 9     x_4c    0.6530015</span></span>
<span><span class="va">summary_lasso</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">lasso_model</span><span class="op">)</span></span>
<span><span class="va">summary_lasso</span></span>
<span><span class="co">#&gt;   subgroup trt.estimate</span></span>
<span><span class="co">#&gt; 1     x_1a    0.6500483</span></span>
<span><span class="co">#&gt; 2     x_1b    0.6493824</span></span>
<span><span class="co">#&gt; 3     x_2a    0.6493749</span></span>
<span><span class="co">#&gt; 4     x_2b    0.6501893</span></span>
<span><span class="co">#&gt; 5     x_3a    0.6497598</span></span>
<span><span class="co">#&gt; 6     x_3b    0.6489794</span></span>
<span><span class="co">#&gt; 7     x_4a    0.6474298</span></span>
<span><span class="co">#&gt; 8     x_4b    0.6467309</span></span>
<span><span class="co">#&gt; 9     x_4c    0.6467375</span></span></code></pre></div>
<p>We can obtain a forest plot for each one of these fitted models:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">summary_ridge</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_guide_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">summary_lasso</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_guide_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="horseshoe-model">Horseshoe model<a class="anchor" aria-label="anchor" href="#horseshoe-model"></a>
</h3>
<p>We are now going to fit a Bayesian model with a horseshoe prior on
the subgroup-treatment interactions. Fitting this kind of models usually
takes a bit of time. We can modify some parameters like the number of
Markov chains, the number of iterations or the number of warmup
iterations (between others). The parameters that we can change are found
in the documentation of the <code>brm</code> function from the brms
package.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">horseshoe_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/horseshoe.html">horseshoe</a></span><span class="op">(</span></span>
<span>  resp <span class="op">=</span> <span class="st">"tt_pfs"</span>, trt <span class="op">=</span> <span class="st">"arm"</span>,</span>
<span>  subgr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x_1"</span>, <span class="st">"x_2"</span>, <span class="st">"x_3"</span>, <span class="st">"x_4"</span><span class="op">)</span>,</span>
<span>  covars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"x_1"</span>, <span class="st">"x_2"</span>, <span class="st">"x_3"</span>, <span class="st">"x_4"</span>, <span class="st">"x_5"</span>,</span>
<span>    <span class="st">"x_6"</span>, <span class="st">"x_7"</span>, <span class="st">"x_8"</span>, <span class="st">"x_9"</span>, <span class="st">"x_10"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">example_data</span>, resptype <span class="op">=</span> <span class="st">"survival"</span>,</span>
<span>  status <span class="op">=</span> <span class="st">"ev_pfs"</span>, chains <span class="op">=</span> <span class="fl">2</span>, seed <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Compiling Stan program...</span></span>
<span><span class="co">#&gt; Trying to compile a simple C file</span></span>
<span><span class="co">#&gt; Running /usr/local/lib/R/bin/R CMD SHLIB foo.c</span></span>
<span><span class="co">#&gt; gcc -I"/usr/local/lib/R/include" -DNDEBUG   -I"/usr/local/lib/R/site-library/Rcpp/include/"  -I"/usr/local/lib/R/site-library/RcppEigen/include/"  -I"/usr/local/lib/R/site-library/RcppEigen/include/unsupported"  -I"/usr/local/lib/R/site-library/BH/include" -I"/usr/local/lib/R/site-library/StanHeaders/include/src/"  -I"/usr/local/lib/R/site-library/StanHeaders/include/"  -I"/usr/local/lib/R/site-library/RcppParallel/include/"  -I"/usr/local/lib/R/site-library/rstan/include" -DEIGEN_NO_DEBUG  -DBOOST_DISABLE_ASSERTS  -DBOOST_PENDING_INTEGER_LOG2_HPP  -DSTAN_THREADS  -DBOOST_NO_AUTO_PTR  -include '/usr/local/lib/R/site-library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp'  -D_REENTRANT -DRCPP_PARALLEL_USE_TBB=1   -I/usr/local/include   -fpic  -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -Wdate-time -D_FORTIFY_SOURCE=2 -g  -c foo.c -o foo.o</span></span>
<span><span class="co">#&gt; In file included from /usr/local/lib/R/site-library/RcppEigen/include/Eigen/Core:88,</span></span>
<span><span class="co">#&gt;                  from /usr/local/lib/R/site-library/RcppEigen/include/Eigen/Dense:1,</span></span>
<span><span class="co">#&gt;                  from /usr/local/lib/R/site-library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13,</span></span>
<span><span class="co">#&gt;                  from &lt;command-line&gt;:</span></span>
<span><span class="co">#&gt; /usr/local/lib/R/site-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:1: error: unknown type name ‘namespace’</span></span>
<span><span class="co">#&gt;   628 | namespace Eigen {</span></span>
<span><span class="co">#&gt;       | ^~~~~~~~~</span></span>
<span><span class="co">#&gt; /usr/local/lib/R/site-library/RcppEigen/include/Eigen/src/Core/util/Macros.h:628:17: error: expected ‘=’, ‘,’, ‘;’, ‘asm’ or ‘__attribute__’ before ‘{’ token</span></span>
<span><span class="co">#&gt;   628 | namespace Eigen {</span></span>
<span><span class="co">#&gt;       |                 ^</span></span>
<span><span class="co">#&gt; In file included from /usr/local/lib/R/site-library/RcppEigen/include/Eigen/Dense:1,</span></span>
<span><span class="co">#&gt;                  from /usr/local/lib/R/site-library/StanHeaders/include/stan/math/prim/mat/fun/Eigen.hpp:13,</span></span>
<span><span class="co">#&gt;                  from &lt;command-line&gt;:</span></span>
<span><span class="co">#&gt; /usr/local/lib/R/site-library/RcppEigen/include/Eigen/Core:96:10: fatal error: complex: No such file or directory</span></span>
<span><span class="co">#&gt;    96 | #include &lt;complex&gt;</span></span>
<span><span class="co">#&gt;       |          ^~~~~~~~~</span></span>
<span><span class="co">#&gt; compilation terminated.</span></span>
<span><span class="co">#&gt; make: *** [/usr/local/lib/R/etc/Makeconf:169: foo.o] Error 1</span></span>
<span><span class="co">#&gt; Start sampling</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL '4c88d91c9772512e42eae9279bcb6c67' NOW (CHAIN 1).</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Gradient evaluation took 0.001074 seconds</span></span>
<span><span class="co">#&gt; Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 10.74 seconds.</span></span>
<span><span class="co">#&gt; Chain 1: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; Chain 1:  Elapsed Time: 48.4292 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 1:                46.2427 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 1:                94.6719 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 1: </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SAMPLING FOR MODEL '4c88d91c9772512e42eae9279bcb6c67' NOW (CHAIN 2).</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Gradient evaluation took 0.000569 seconds</span></span>
<span><span class="co">#&gt; Chain 2: 1000 transitions using 10 leapfrog steps per transition would take 5.69 seconds.</span></span>
<span><span class="co">#&gt; Chain 2: Adjust your expectations accordingly!</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2: Iteration:    1 / 2000 [  0%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  200 / 2000 [ 10%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  400 / 2000 [ 20%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  600 / 2000 [ 30%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration:  800 / 2000 [ 40%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1000 / 2000 [ 50%]  (Warmup)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1001 / 2000 [ 50%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1200 / 2000 [ 60%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1400 / 2000 [ 70%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1600 / 2000 [ 80%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 1800 / 2000 [ 90%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: Iteration: 2000 / 2000 [100%]  (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2: </span></span>
<span><span class="co">#&gt; Chain 2:  Elapsed Time: 47.5964 seconds (Warm-up)</span></span>
<span><span class="co">#&gt; Chain 2:                32.5793 seconds (Sampling)</span></span>
<span><span class="co">#&gt; Chain 2:                80.1756 seconds (Total)</span></span>
<span><span class="co">#&gt; Chain 2:</span></span>
<span><span class="co">#&gt; Warning: There were 3 divergent transitions after warmup. See</span></span>
<span><span class="co">#&gt; https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span></span>
<span><span class="co">#&gt; to find out why this is a problem and how to eliminate them.</span></span>
<span><span class="co">#&gt; Warning: Examine the pairs() plot to diagnose sampling problems</span></span></code></pre></div>
<p>Once that the model is fitted we have to check if there are
convergence problems. In this case we obtained 3 divergent transitions
after warmup. In general if there are few divergent transitions (taking
into account the total number of iterations, in this case 2000 after
warmup) and there are no other problems like high Rhats we can continue
with our analysis. This is what happens in our example: we have 3
divergent transitions after warmup out of 2000 and there are no other
problems.</p>
<p>We can obtain a summary of the posterior distributions of the
coefficients of the fitted model:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">horseshoe_model</span><span class="op">$</span><span class="va">fit</span></span>
<span><span class="co">#&gt; Warning: There were 3 divergent transitions after warmup. Increasing</span></span>
<span><span class="co">#&gt; adapt_delta above 0.95 may help. See</span></span>
<span><span class="co">#&gt; http://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup</span></span>
<span><span class="co">#&gt;  Family: cox </span></span>
<span><span class="co">#&gt;   Links: mu = log </span></span>
<span><span class="co">#&gt; Formula: tt_pfs | cens(1 - ev_pfs) ~ a + b </span></span>
<span><span class="co">#&gt;          a ~ 0 + arm0 + arm1 + x_1b + x_2b + x_3b + x_4b + x_4c + x_5b + x_5c + x_5d + x_6b + x_7b + x_8b + x_8c + x_9b + x_10b + x_10c</span></span>
<span><span class="co">#&gt;          b ~ 0 + x_1a_arm + x_1b_arm + x_2a_arm + x_2b_arm + x_3a_arm + x_3b_arm + x_4a_arm + x_4b_arm + x_4c_arm + x_5a_arm + x_5b_arm + x_5c_arm + x_5d_arm + x_6a_arm + x_6b_arm + x_7a_arm + x_7b_arm + x_8a_arm + x_8b_arm + x_8c_arm + x_9a_arm + x_9b_arm + x_10a_arm + x_10b_arm + x_10c_arm</span></span>
<span><span class="co">#&gt;    Data: data_model (Number of observations: 1000) </span></span>
<span><span class="co">#&gt;   Draws: 2 chains, each with iter = 2000; warmup = 1000; thin = 1;</span></span>
<span><span class="co">#&gt;          total post-warmup draws = 2000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Population-Level Effects: </span></span>
<span><span class="co">#&gt;             Estimate Est.Error l-95% CI u-95% CI Rhat Bulk_ESS Tail_ESS</span></span>
<span><span class="co">#&gt; a_arm0         -0.29      0.36    -0.98     0.42 1.00      963     1113</span></span>
<span><span class="co">#&gt; a_arm1         -0.80      0.47    -1.79     0.09 1.00      916      905</span></span>
<span><span class="co">#&gt; a_x_1b         -0.07      0.14    -0.34     0.20 1.00     2235     1561</span></span>
<span><span class="co">#&gt; a_x_2b          0.06      0.15    -0.21     0.36 1.00     2227     1009</span></span>
<span><span class="co">#&gt; a_x_3b         -0.30      0.17    -0.63     0.01 1.00     1696     1437</span></span>
<span><span class="co">#&gt; a_x_4b         -0.26      0.16    -0.59     0.06 1.00     1427      927</span></span>
<span><span class="co">#&gt; a_x_4c         -0.56      0.17    -0.90    -0.23 1.00     1797     1334</span></span>
<span><span class="co">#&gt; a_x_5b          0.02      0.27    -0.49     0.56 1.00     1239     1439</span></span>
<span><span class="co">#&gt; a_x_5c         -0.15      0.22    -0.59     0.32 1.00     1003      843</span></span>
<span><span class="co">#&gt; a_x_5d         -0.24      0.21    -0.62     0.22 1.00      980      964</span></span>
<span><span class="co">#&gt; a_x_6b          0.20      0.15    -0.07     0.52 1.00     1973     1337</span></span>
<span><span class="co">#&gt; a_x_7b          0.07      0.16    -0.27     0.37 1.00     1779     1499</span></span>
<span><span class="co">#&gt; a_x_8b          0.01      0.19    -0.39     0.38 1.00     1701     1533</span></span>
<span><span class="co">#&gt; a_x_8c         -0.00      0.19    -0.37     0.35 1.00     1496     1440</span></span>
<span><span class="co">#&gt; a_x_9b          0.08      0.18    -0.28     0.44 1.00     1397     1109</span></span>
<span><span class="co">#&gt; a_x_10b         0.18      0.20    -0.18     0.57 1.00     1375     1453</span></span>
<span><span class="co">#&gt; a_x_10c         0.16      0.19    -0.21     0.54 1.00     1231     1270</span></span>
<span><span class="co">#&gt; b_x_1a_arm      0.00      0.09    -0.19     0.21 1.00     1687     1171</span></span>
<span><span class="co">#&gt; b_x_1b_arm     -0.01      0.09    -0.22     0.16 1.00     1892     1765</span></span>
<span><span class="co">#&gt; b_x_2a_arm      0.01      0.10    -0.16     0.25 1.00     1909     1576</span></span>
<span><span class="co">#&gt; b_x_2b_arm     -0.01      0.10    -0.27     0.18 1.00     1565     1182</span></span>
<span><span class="co">#&gt; b_x_3a_arm     -0.05      0.14    -0.46     0.11 1.00     1219      991</span></span>
<span><span class="co">#&gt; b_x_3b_arm      0.04      0.15    -0.13     0.51 1.00     1336     1151</span></span>
<span><span class="co">#&gt; b_x_4a_arm     -0.01      0.13    -0.26     0.17 1.00     1493      969</span></span>
<span><span class="co">#&gt; b_x_4b_arm     -0.02      0.13    -0.34     0.17 1.00     1484     1058</span></span>
<span><span class="co">#&gt; b_x_4c_arm      0.05      0.16    -0.10     0.45 1.00     1142      958</span></span>
<span><span class="co">#&gt; b_x_5a_arm      0.09      0.21    -0.08     0.76 1.00      922      932</span></span>
<span><span class="co">#&gt; b_x_5b_arm     -0.07      0.20    -0.73     0.10 1.00     1330     1481</span></span>
<span><span class="co">#&gt; b_x_5c_arm     -0.01      0.09    -0.25     0.14 1.00     2554     1606</span></span>
<span><span class="co">#&gt; b_x_5d_arm      0.01      0.09    -0.14     0.23 1.00     2023     1711</span></span>
<span><span class="co">#&gt; b_x_6a_arm      0.03      0.11    -0.12     0.36 1.00     1388     1005</span></span>
<span><span class="co">#&gt; b_x_6b_arm     -0.02      0.11    -0.30     0.14 1.00     1499      888</span></span>
<span><span class="co">#&gt; b_x_7a_arm     -0.06      0.16    -0.56     0.11 1.00     1433     1450</span></span>
<span><span class="co">#&gt; b_x_7b_arm      0.05      0.14    -0.09     0.48 1.00     1311     1543</span></span>
<span><span class="co">#&gt; b_x_8a_arm     -0.02      0.12    -0.37     0.13 1.00     1891     1317</span></span>
<span><span class="co">#&gt; b_x_8b_arm     -0.02      0.11    -0.33     0.14 1.00     2060     1664</span></span>
<span><span class="co">#&gt; b_x_8c_arm      0.04      0.13    -0.09     0.43 1.01     1551     1559</span></span>
<span><span class="co">#&gt; b_x_9a_arm     -0.04      0.15    -0.48     0.11 1.00     1336     1454</span></span>
<span><span class="co">#&gt; b_x_9b_arm      0.04      0.15    -0.12     0.48 1.00     1917     1222</span></span>
<span><span class="co">#&gt; b_x_10a_arm     0.00      0.10    -0.21     0.23 1.00     1884     1550</span></span>
<span><span class="co">#&gt; b_x_10b_arm     0.01      0.10    -0.16     0.27 1.00     2010     1365</span></span>
<span><span class="co">#&gt; b_x_10c_arm    -0.02      0.09    -0.28     0.14 1.00     1974     1736</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Draws were sampled using sampling(NUTS). For each parameter, Bulk_ESS</span></span>
<span><span class="co">#&gt; and Tail_ESS are effective sample size measures, and Rhat is the potential</span></span>
<span><span class="co">#&gt; scale reduction factor on split chains (at convergence, Rhat = 1).</span></span></code></pre></div>
<p>Apart from the fitted model this <code>horseshoe</code> object also
contains the data, the response, the design and dummy matrices, the kind
of response and the subgroup names.</p>
<p>We are now going to call summary of this object to obtain the
subgroup hazard ratio estimates. With this summary we are also going to
obtain the samples of the approximate posterior distribution of the
subgroup hazard ratios. The estimates are just the median of this
approximate posterior distribution. We should select a confidence level
in order to obtain credible intervals for the subgroup treatment
effects. The default confidence level is 95%.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">summary_horseshoe</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">horseshoe_model</span>, conf <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span></span>
<span><span class="va">summary_horseshoe</span></span>
<span><span class="co">#&gt;   subgroup trt.estimate   trt.low  trt.high</span></span>
<span><span class="co">#&gt; 1     x_1a    0.6592278 0.5242579 0.8175955</span></span>
<span><span class="co">#&gt; 2     x_1b    0.6520480 0.5176570 0.8047114</span></span>
<span><span class="co">#&gt; 3     x_2a    0.6589804 0.5256111 0.8302599</span></span>
<span><span class="co">#&gt; 4     x_2b    0.6543356 0.5208846 0.8019683</span></span>
<span><span class="co">#&gt; 5     x_3a    0.6266290 0.4371677 0.7901107</span></span>
<span><span class="co">#&gt; 6     x_3b    0.6656145 0.5321776 0.8219393</span></span>
<span><span class="co">#&gt; 7     x_4a    0.6399664 0.4974540 0.8018384</span></span>
<span><span class="co">#&gt; 8     x_4b    0.6455010 0.4870914 0.8038556</span></span>
<span><span class="co">#&gt; 9     x_4c    0.6707361 0.5306578 0.8813829</span></span></code></pre></div>
<p>We can obtain a forest plot with the treatment effect estimates and
the credible intervals.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">summary_horseshoe</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_guide_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="comparison-of-the-methods">Comparison of the Methods<a class="anchor" aria-label="anchor" href="#comparison-of-the-methods"></a>
</h2>
<p>A last useful thing that we can do is to compare the different
treatment effect estimates. For that we are first going to generate a
data set with all the estimated hazard ratios and then we are going to
plot all of them in a common forest plot.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">comparison_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare.html">compare</a></span><span class="op">(</span><span class="va">naivepop_model</span>, <span class="va">naive_model</span>, <span class="va">ridge_model</span>, <span class="va">lasso_model</span>, <span class="va">horseshoe_model</span><span class="op">)</span></span>
<span><span class="va">comparison_data</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt;    subgroup trt.estimate   trt.low  trt.high                 model</span></span>
<span><span class="co">#&gt; 1      x_1a    0.6741880 0.4693783 0.9683648                 Naive</span></span>
<span><span class="co">#&gt; 2      x_1b    0.6645867 0.4663568 0.9470762                 Naive</span></span>
<span><span class="co">#&gt; 3      x_2a    0.7087873 0.4743926 1.0589952                 Naive</span></span>
<span><span class="co">#&gt; 4      x_2b    0.6424496 0.4636818 0.8901394                 Naive</span></span>
<span><span class="co">#&gt; 5      x_3a    0.5054825 0.3003642 0.8506759                 Naive</span></span>
<span><span class="co">#&gt; 6      x_3b    0.7168399 0.5365623 0.9576884                 Naive</span></span>
<span><span class="co">#&gt; 7      x_4a    0.6213593 0.4133445 0.9340571                 Naive</span></span>
<span><span class="co">#&gt; 8      x_4b    0.5428680 0.3372320 0.8738959                 Naive</span></span>
<span><span class="co">#&gt; 9      x_4c    0.8575696 0.5483543 1.3411505                 Naive</span></span>
<span><span class="co">#&gt; 10     x_1a    0.6514162 0.6514162 0.6514162 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 11     x_1b    0.6494716 0.6494716 0.6494716 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 12     x_2a    0.6511461 0.6511461 0.6511461 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 13     x_2b    0.6501897 0.6501897 0.6501897 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 14     x_3a    0.6413243 0.6413243 0.6413243 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 15     x_3b    0.6523088 0.6523088 0.6523088 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 16     x_4a    0.6449626 0.6449626 0.6449626 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 17     x_4b    0.6449838 0.6449838 0.6449838 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 18     x_4c    0.6530015 0.6530015 0.6530015 Elastic net alpha = 0</span></span>
<span><span class="co">#&gt; 19     x_1a    0.6500483 0.6500483 0.6500483 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 20     x_1b    0.6493824 0.6493824 0.6493824 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 21     x_2a    0.6493749 0.6493749 0.6493749 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 22     x_2b    0.6501893 0.6501893 0.6501893 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 23     x_3a    0.6497598 0.6497598 0.6497598 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 24     x_3b    0.6489794 0.6489794 0.6489794 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 25     x_4a    0.6474298 0.6474298 0.6474298 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 26     x_4b    0.6467309 0.6467309 0.6467309 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 27     x_4c    0.6467375 0.6467375 0.6467375 Elastic net alpha = 1</span></span>
<span><span class="co">#&gt; 28     x_1a    0.6592278 0.4998014 0.8495904             Horseshoe</span></span>
<span><span class="co">#&gt; 29     x_1b    0.6520480 0.4956804 0.8415354             Horseshoe</span></span>
<span><span class="co">#&gt; 30     x_2a    0.6589804 0.5017134 0.8616587             Horseshoe</span></span>
<span><span class="co">#&gt; 31     x_2b    0.6543356 0.4964563 0.8445172             Horseshoe</span></span>
<span><span class="co">#&gt; 32     x_3a    0.6266290 0.4021923 0.8272290             Horseshoe</span></span>
<span><span class="co">#&gt; 33     x_3b    0.6656145 0.5055671 0.8632291             Horseshoe</span></span>
<span><span class="co">#&gt; 34     x_4a    0.6399664 0.4788171 0.8475966             Horseshoe</span></span>
<span><span class="co">#&gt; 35     x_4b    0.6455010 0.4591092 0.8449147             Horseshoe</span></span>
<span><span class="co">#&gt; 36     x_4c    0.6707361 0.5055804 0.9424651             Horseshoe</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $overall_trt</span></span>
<span><span class="co">#&gt; [1] 0.666919</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $resptype</span></span>
<span><span class="co">#&gt; [1] "survival"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "compare.data"</span></span></code></pre></div>
<p>Now we plot all the estimated subgroup hazard ratios and we add a
vertical line indicating the value of the overall hazard ratio.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">comparison_data</span><span class="op">)</span></span></code></pre></div>
<p><img src="example_guide_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<p>In the case of having survival data the procedure would be analogous
but instead of having survival <code>resptype</code> we would have
binary. Also the response variable should be a numeric variable with 1
and 0 and there would be no status variable.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mar Vazquez Rabunal.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
